<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ecoverde - Formulario de Cadastro</title>
    <link rel="stylesheet" href="../styles/form.css">
    <link rel="stylesheet" href="../styles/global.css">
    <link rel="icon" href="../assets/ChatGPT Image 1 de abr. de 2025, 22_14_11.png" type="image/png">
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
</head>

<body>
  <header class="header__container">
    <img  class="header__container__logo" src="../assets/ChatGPT Image 1 de abr. de 2025, 22_14_11.png" alt="logo">
    <nav>
      <a href="index.html">Início</a>
      <a href="form.html">Cadastro</a>
    </nav>
  </header>
  <main>
    <div class="main__container__form">
      <form class="form" action="#" method="post">
        <div class="form_grupo">
          <label for="nome" class="form_label">Nome</label>
          <input type="text" name="nome" class="form_input" id="nome" placeholder="Nome" required>
        </div>
          <div class="form_grupo">
            <label for="e-mail" class="form_label">Email</label>
            <input type="email" name="email" class="form_input" id="email" placeholder="seuemail@email.com" required>
          </div>
          <div class="form_grupo">
            <label for="datanascimento" class="form_label">Data de Nascimento</label>
            <input type="date" name="datanascimento" class="form_input" id="datanascimento" placeholder="Data de Nascimento" required>
          </div> 
          <div class="form_grupo">
            <label for="telefone" class="form_label">Telefone</label>
            <input type="tel" name="telefone" class="form_input" id="telefone" placeholder="(00) 00000-0000" required>
          </div>
          <div class="form_grupo">
            <label for="endereco" class="form_label">Endereço</label>
            <input type="text" name="endereco" class="form_input" id="endereco" placeholder="Endereço completo" required>
          </div>
          <div class="form_grupo">
            <label for="cidade" class="form_label">Cidade</label>
            <input type="text" name="cidade" class="form_input" id="cidade" placeholder="Cidade" required>
          </div>
          <div class="form_grupo">
            <label for="estado" class="form_label">Estado</label>
            <select name="estado" class="form_input" id="estado" required>
              <option value="" disabled selected>Selecione o estado</option>
              <option value="AC">Acre</option>
              <option value="AL">Alagoas</option>
              <option value="AP">Amapá</option>
              <option value="AM">Amazonas</option>
              <option value="BA">Bahia</option>
              <option value="CE">Ceará</option>
              <option value="DF">Distrito Federal</option>
              <option value="ES">Espírito Santo</option>
              <option value="GO">Goiás</option>
              <option value="MA">Maranhão</option>
              <option value="MT">Mato Grosso</option>
              <option value="MS">Mato Grosso do Sul</option>
              <option value="MG">Minas Gerais</option>
              <option value="PA">Pará</option>
              <option value="PB">Paraíba</option>
              <option value="PR">Paraná</option>
              <option value="PE">Pernambuco</option>
              <option value="PI">Piauí</option>
              <option value="RJ">Rio de Janeiro</option>
              <option value="RN">Rio Grande do Norte</option>
              <option value="RS">Rio Grande do Sul</option>
              <option value="RO">Rondônia</option>
              <option value="RR">Roraima</option>
              <option value="SC">Santa Catarina</option>
              <option value="SP">São Paulo</option>
              <option value="SE">Sergipe</option>
              <option value="TO">Tocantins</option>
            </select>
          </div>
          <div class="form_grupo">
            <label for="cep" class="form_label">CEP</label>
            <input type="text" name="cep" class="form_input" id="cep" placeholder="00000-000" required>
          </div>
          <div class="form_grupo">
            <label for="genero" class="form_label">Gênero</label>
            <select name="genero" class="form_input" id="genero" required>
              <option value="" disabled selected>Selecione o gênero</option>
              <option value="masculino">Masculino</option>
              <option value="feminino">Feminino</option>
              <option value="outro">Outro</option>
              <option value="prefiro_nao_dizer">Prefiro não dizer</option>
            </select>
          </div>
          <div class="form_grupo">
            <label for="senha" class="form_label">Senha</label>
            <input type="password" name="senha" class="form_input" id="senha" placeholder="Senha" required>
          </div>
          <div class="form_grupo">
            <label for="confirmarsenha" class="form_label">Confirmar Senha</label>
            <input type="password" name="confirmarsenha" class="form_input" id="confirmarsenha" placeholder="Confirmar Senha" required>
          </div>
          <div class="submit">
            <input type="hidden" name="acao" value="enviar">
            <button type="submit" id="buttonIn" name="Submit" class="submit_btn">Cadastrar</button>
          </div>
      </form>
    </div>
        
    <script>
      const form = document.querySelector('form');

      form.addEventListener('submit', async (event) => {
        event.preventDefault();

        if (form.senha.value !== form.confirmarsenha.value) {
          alert('As senhas não coincidem!');
          return;
        }

        const usuario = {
          nome: form.nome.value,
          email: form.email.value,
          datanascimento: form.datanascimento.value,
          telefone: form.telefone.value,
          endereco: form.endereco.value,
          cidade: form.cidade.value,
          estado: form.estado.value,
          cep: form.cep.value,
          genero: form.genero.value,
          senha: form.senha.value,
        };

        try {
          const response = await axios.post('http://localhost:3000/usuarios', usuario);

          alert('Cadastro realizado com sucesso!');
          window.location.href = './entrar.html';
        } catch (error) {
          if (error.response) {
            alert('Erro ao cadastrar: ' + (error.response.data.message || 'Tente novamente.'));
          } else {
            alert('Erro na conexão com o servidor: ' + error.message);
          }
        }
      });
  </script>
  </main>
  <footer class="rodape">
      <p>© 2024 Ecoverde - Todos os direitos reservados.</p>
  </footer>
</body>
</html>